this is the main production ready code 
